function printPdf() {
  var doc = new jspdf.jsPDF({
    unit: "in",
    lineHeight: lineHeight,
    autoPaging: "text"
  });
  var cvDiv = document.getElementById("cv");

  var pageWidth = 8.5,
    lineHeight = 1.2,
    margin = 0.5,
    maxLineWidth = pageWidth - margin * 4,
    fontSize = 10,
    ptsPerInch = 72,
    oneLineHeight = (fontSize * lineHeight) / ptsPerInch;

  var line = 1;
  var prevLines = 1;
  function addText(text) {
    var textLines = doc.setFont("helvetica")
      .setFontSize(fontSize)
      .splitTextToSize(text, maxLineWidth);
    
    var offsetY = (margin + (line+prevLines+1) * oneLineHeight);

    doc.text(textLines, margin, offsetY);

    prevLines += textLines.length;
    line++;
  }

  function processDetails(details) {
    var detailsSummary = details.getElementsByTagName("summary")[0].innerText;
    addText(detailsSummary);
    
    var detailsContent = details.getElementsByClassName("details-content")[0].innerHTML;
    addText(detailsContent);
  }

  // Details
  addText("Sam Nicholson");
  addText("hello@s-nicholson.co.uk");

  // Intro
  var intro = cvDiv.getElementsByTagName("p")[0].innerText;
  addText(intro);

  var detailSections = cvDiv.getElementsByTagName("details");
  for (var d of detailSections) {
    processDetails(d);
    line = 1;
    prevLines = 1;
    doc.addPage();
  }

  var stamp = new Intl.DateTimeFormat('en-GB', {
      dateStyle: "short",
      timeStyle: "short"
    })
    .format(new Date())
    .replace(",", " @");

  addText("This document was autogenerated from https://s-nicholson.co.uk/experience at " + stamp + ", go there to get a more current version.");

  // write file
  doc.output("dataurlnewwindow");
  // doc.save("Sam_Nicholson_CV.pdf");
}

